# Protein protein docking

![alt text](../../img/protein_protein_docking.png?raw=true)

## Quick installation and run

Go to workflow folder and install conda environment:

```bash
conda env create -f environment.yml
conda activate protein_protein_wf1
```

To install it in an HPC environment, do the same after loading the corresponding Conda or Miniconda module.

See options for worklow:

```bash
vi input_HPC.yml
python biobb_pp_docking.py --help
```

See [biobb documentation](https://mmb.irbbarcelona.org/biobb/documentation/source) for additional properties not included in the YAML configuration file.

To run in an HPC environment adapt the run_HPC.sl and input_HPC.yml scripts and send a job to the slurm queue:

```bash
sbatch run_HPC.sl
```

The output will be generated in the "working_dir_path" folder selected in the corresponding YAML input. The global log files will be in "/working_dir_path/log.out" and "/working_dir_path/log.err". Each step will have its own log files and output in a separate folder inside "/working_dir_path".

## Description

This workflow has several steps. The input for the workflow are two protein pdb files containing the ligand protein and the receptor protein. Their paths can be provided through the YAML configuration file or through the command line arguments. The YAML configuration file will contain the default settings and paths of the workflow. The command line arguments can be used to provide some inputs and settings that will be prioritized over those in the YAML configuration file.

- **Step 1**: prepare the protein pdb files to a format that can be used by pyDock. In these step a new chain has to be chosen for each protein. The "mol" keyword will refer to the original chain for each protein. The "newmol" chain must be different for the receptor and the ligand. 

- **Steps 2**: Ftdock is used to generate docking positions for the two proteins and rotftdock is used to calculate the translation and rotation matrices that transform the original conformations into the docking positions generated by Ftdock.

- **Step 3**: use pyDock energy function to score and rank all the docking positions generated in the previous step.

- **Step 4**: use makePDB to generate pdb files for all the docking positions between 'rank1' and 'rank2'. Zip all the pdb files in a single file.

- **Step 5**: cluster the pdb files generated in the previous step according to the RMSD between them and using the hierarchical clustering algorithm. Chose the best ranking pose from each cluster to obtain good, uncorrelated docking poses.


